{% extends "base.html" %}

{% block content %}
<style>
  .card {
    background: var(--card-bg, #fff);
    border-radius: 8px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.06);
    padding: 1.25rem;
  }
  .form-group { margin-bottom: 1rem; }
  label { display:block; margin-bottom: 0.35rem; font-weight:600; }
  input[type="number"], select {
    width:100%;
    padding: .55rem .7rem;
    border-radius:6px;
    border:1px solid #d0d7de;
    box-sizing:border-box;
    font-size:1rem;
    background: var(--input-bg, #fff);
    color: var(--input-color, #111);
  }

  /* Force visible text for doctor select and options */
  select, select option {
    color: #111 !important;
    background: #fff !important;
  }

  .btn { padding:.65rem .9rem; border-radius:6px; border:none; cursor:pointer; }
  .btn-primary { background: #2563eb; color:#fff; }
  h3 { margin-top: 1.25rem; margin-bottom: .6rem; }
  .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 1rem; }
</style>

<div class="card" style="max-width: 980px; margin: 1.5rem auto;">
    <h2 style="text-align: center; margin-bottom: 1rem;">New Assessment</h2>

    <form method="POST" novalidate>
        <h3 style="margin: 1rem 0 0.5rem; color: var(--primary, #2563eb);">Image Features</h3>

        <div class="grid">
            <div class="form-group">
                <label for="exudates_count">Exudates Count</label>
                <input type="number" id="exudates_count" name="exudates_count" min="0" placeholder="e.g., 5" required>
            </div>

            <div class="form-group">
                <label for="hemorrhages_count">Hemorrhages Count</label>
                <input type="number" id="hemorrhages_count" name="hemorrhages_count" min="0" placeholder="e.g., 2" required>
            </div>

            <div class="form-group">
                <label for="microaneurysms_count">Microaneurysms Count</label>
                <input type="number" id="microaneurysms_count" name="microaneurysms_count" min="0" placeholder="e.g., 10" required>
            </div>

            <div class="form-group">
                <label for="vessel_tortuosity">Vessel Tortuosity</label>
                <input type="number" id="vessel_tortuosity" name="vessel_tortuosity" step="0.01" min="0" placeholder="e.g., 0.85" required>
            </div>

            <div class="form-group">
                <label for="macular_thickness">Macular Thickness</label>
                <input type="number" id="macular_thickness" name="macular_thickness" step="0.01" min="0" placeholder="e.g., 250" required>
            </div>
        </div>

        <h3 style="margin: 1.25rem 0 0.5rem; color: var(--primary, #2563eb);">Clinical Features</h3>

        <div class="grid">
            <div class="form-group">
                <label for="fasting_glucose">Fasting Glucose (mg/dL)</label>
                <input type="number" id="fasting_glucose" name="fasting_glucose" step="0.01" min="0" placeholder="e.g., 120" required>
            </div>

            <div class="form-group">
                <label for="hba1c">HbA1c (%)</label>
                <input type="number" id="hba1c" name="hba1c" step="0.01" min="0" placeholder="e.g., 6.5" required>
            </div>

            <div class="form-group">
                <label for="diabetes_duration">Diabetes Duration (years)</label>
                <input type="number" id="diabetes_duration" name="diabetes_duration" step="0.01" min="0" placeholder="e.g., 5" required>
            </div>
        </div>

        <div class="form-group" style="margin-top: 1.25rem;">
            <label for="doctor_id">Assign to Doctor (Optional)</label>
            <select id="doctor_id" name="doctor_id">
                <option value="">-- Self-Assessment --</option>
                {% for doc in doctors %}
                    <option value="{{ doc._id }}">{{ doc.name }} ({{ doc.username }})</option>
                {% endfor %}
            </select>
        </div>

        <button type="submit" class="btn btn-primary" style="width: 100%; font-size: 1.05rem; margin-top: 1rem;">Submit Assessment</button>
    </form>
</div>
{% endblock %}
